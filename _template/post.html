{% extends "layout.html" %}

{% block title %}{{post.title}} | {{context.sitename}}{% endblock %}

{% block author %}
<meta name="author" content="{{ post.author }}" />
{% endblock %}

{% block afterstyle %}
<meta name="description" content="{{ post.summary }}" />
{% if post.get('tags') %}
<meta name="keywords" content="lepture, {{ post.tags|join(',') }}" />
{% endif %}
{% if post.get('folder') == 'work' %}
<link rel="stylesheet" href="{{ static_url('css/syntax.css') }}" />
{% endif %}
<link rel="canonical" href="{{ content_url(post.slug) }}" />
<script type="text/javascript">
    var currentNav = '#nav-{{post.folder}}';
</script>
{% endblock %}

{% block brand%}<a class="article-title" href="{{content_url(post.slug)}}" rel="self">{{post.title}}</a>{% endblock %}

{% block container %}
<div class="article">
    <div class="article-content">
        {{ post.content }}
    </div>
    <div class="fn-clear">
        <p class="article-rel fn-right">
        {% if post.prev %}
        <a id="prev-article" href="{{content_url(post.prev.slug)}}" title="{{post.prev.title}}" rel="prev">«Prev</a>
        {% endif %}
        {% if post.next %}
        <a id="next-article" href="{{content_url(post.next.slug)}}" title="{{post.next.title}}" rel="next">Next»</a>
        {% endif %}
        </p>
    </div>
</div>
<div class="article-meta fn-clear">
    <p class="article-time fn-left">
    Created at: 
    <a href="{{content_url(post.date.year)}}" rel=archive"><time datetime="{{post.date}}">{{post.date.strftime("%a, %b %d, %Y")}}</time></a>
    </p>
    <p class="article-tags fn-left">
    Tagged in:
    {% for tag in post.get('tags',[]) %}
    <a href="{{content_url('tag', tag)}}" class="tag" rel="tag">{{tag}}</a>
    {% endfor %}
    </p>
</div>
{% include "disqus.html" %}
{% endblock %}

{% block afterjquery %}
<script type="text/javascript">
    $(function(){$(document).keydown(function(e){
                var tagName = e.target.tagName.toLowerCase();
                if("input" == tagName|| "textarea" == tagName){return ;}
                if(37 == e.keyCode || 72 == e.keyCode){
                var url = $('#prev-article').attr('href');
                }else if(39 == e.keyCode || 76 == e.keyCode){
                var url = $('#next-article').attr('href');
                }
                var url = url || '';
                if(url){location.assign(url);}
                });
            });
        </script>
        {% endblock %}
