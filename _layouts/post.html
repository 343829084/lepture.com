{% extends "layout.html" %}

{% block title %}{{ page.title }} — {{ site.name }}{% endblock %}

{% block extra_meta %}
  {% include "twitter-card.html" %}
{% endblock %}

{% macro WebPage(schema='Article') %}
<article id="main" role="main" class="hentry yue" itemscope itemtype="http://schema.org/{{schema}}">
  {% include "article-header.html" %}

  <div class="entry-content container" itemprop="articleBody">
    {{ page.body|markdown(lazyimg=True) }}
  </div>

  <div class="entry-footer container">
    {% if page.review %}
      <span itemprop="itemReviewed">{{ page.review }}</span>
      Reviewed by
      <span class="author vcard">
        <span class="fn" itemprop="author">{{ site.author }}</span>
      </span>
      {% if page.rating %}
      — Rating <span itemprop="reviewRating" itemscope itemtype="http://schema.org/Rating"><span itemprop="ratingValue">{{ page.rating }}</span></span>
      {% endif %}
    {% else %}
      <span class="author vcard">
        <span class="fn" itemprop="author">{{ site.author }}</span>
      </span>
    {% endif %}
  </div>
</article>
{% endmacro %}


{% block main %}
  {% if page.review %}
    {{ WebPage("Review") }}
  {% else %}
    {{ WebPage("Article") }}
  {% endif %}

  <div class="entry-extra container">
    {% if page.tags %}
    <div class="entry-tags">
      {% for tag in page.tags %}
      <span class="tag">{{ tag }}</span>
      {% endfor %}
    </div>
    {% endif %}

    <div class="social-button" data-url="{{ site.baseurl }}{{ page.url }}" data-text="{{ page.title }}{% if page.description %} — {{ page.description }}{% endif %}" data-twitter="lepture" data-weibo="lepture" data-facebook="lepture" data-count="true"></div>
  </div>

  {% include "disqus.html" %}
{% endblock %}
